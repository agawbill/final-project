
<div class="container">
  <div class="col-md-8">

    <h2>List<span class="symbol"> #</span> <%=@list.name%></h2>
    <p>
      <div id="boxWrapper">
      <span class="movieTitle">Description:</span></p>
      <%=@list.description%></p>
      <span class='movieDetails'> Created by: </span><span class='movieInfo'>
      <%=User.find(@list.user_id).email%></span>
      <p><span class="movieDetails"><%=link_to like_list_path(@list), class: "link", method: :put do%></span>

      <p>&#128077; (<%= @list.get_upvotes.size %>)
      <%end%>

      <span class="movieDetails"><%=link_to dislike_list_path(@list), class: "link", method: :put do%></span>
      &#128078;	 (<%= @list.get_downvotes.size %>)
      <%end%></p>

    </div>

    <%@movieLists.each do |movie| %>




  <p>
    <div id="boxWrapper"><span class='movieTitle'>
  <%=movie.original_title%></span>
  <span class="quote">  <%=form_tag("/lists", method: "get", :remote => "true") do%>
  <%= hidden_field_tag :s, movie.id%>
  <%=submit_tag("Similar movies", :class => "similiar_submit")%>
  <%end%></span><br>
  <i><%=movie.tagline%></i>
  <hr>

  <img src='https://image.tmdb.org/t/p/w500/<%=movie.poster_path%>' id='movieImg'>
  <span class='movieDetails'> Webpage: </span>
  <span class='movieInfo'><a href="<%=movie.homepage%>"><%=movie.homepage%></a></span><br>
  <span class='movieDetails'> Rating: </span><span class='movieInfo'>
  <%=movie.vote_average%></span><br>
  <span class='movieDetails'> Popularity: </span><span class='movieInfo'>
  <%=movie.popularity%></span><br><br>
  <span class='movieDetails'>Overview: </span><p>
  <%=movie.overview%></p></center>

  </p>
</div>
<%end%>
</div>


<div class="col-md-4">
  <h2>Share<span class="symbol">#</span>list</h2>

  <p><div id="boxWrapper">
    <span class="movieTitle">Like it? Share it!</span><p>
    <%= social_share_button_tag(@list.name, :url => "http://myapp.com/foo/bar") %>
  </div></p>
<h2>Similar<span class="symbol">#</span>movies</h2>
  <p>

    <div id="loading">
      <center><%=image_tag "loading.gif", :class => "loadingImg"%></center>
    </div>
      <div id="displayMovies">
        Click "show similar movies" next to each movie title to get simiar film suggestions.
      </div>
  </div></p>
</div>
</div>












<script>

$( document ).ajaxStart(function() {
    $( "#loading" ).show();
});

$( document ).ajaxStop(function() {
    $( "#loading" ).hide();
});

$(document).ready(function(){

  var displayMovies= document.getElementById('displayMovies')
$('.similiar_submit').on('click',function(event){
$( "#displayMovies" ).empty();
var form=$(this).parent('form');


$.ajax({
      type: "GET",
      url: "<%=list_path%>",
      data: form.serialize(),
      dataType: "JSON",

      success: function(data){
        var movies=data.movies.table.results;
        for(i=0;i<movies.length;i++){

          $('#displayMovies').append(
            "<p><div class='boxWrapper2'><div class='movieHeader'><span class='movieTitle'>"
            +movies[i].table.original_title
            +"</span></div> <br><img src='https://image.tmdb.org/t/p/w500/"
            +movies[i].table.poster_path+"' id='movieImg'><span class='movieDetails'> Rating: </span><span class='movieInfo'>"
            +movies[i].table.vote_average+"</span><br><span class='movieDetails'> Release date: </span><span class='movieInfo'>"
            +movies[i].table.release_date+"</span><br><br><span class='movieDetails'> Overview: </span>"
            +movies[i].table.overview+"</br> <center></center></div><p style='clear: both;'> ")
            
          }
          console.log(data.movies.table.results);
        }

  });

  });
})

</script>
